{
  "Name": "Certutil.exe",
  "Description": "Windows binary used for handling certificates",
  "Author": "Oddvar Moe",
  "Created": "2018-05-25",
  "Commands": [
    {
      "Command": "certutil.exe -urlcache -split -f http://7-zip.org/a/7z1604-x64.exe 7zip.exe",
      "Description": "Download and save 7zip to disk in the current folder.",
      "Usecase": "Download file from Internet",
      "Category": "Download",
      "Privileges": "User",
      "MitreID": "T1105",
      "OperatingSystem": "Windows vista, Windows 7, Windows 8, Windows 8.1, Windows 10, Windows 11"
    },
    {
      "Command": "certutil.exe -verifyctl -f -split http://7-zip.org/a/7z1604-x64.exe 7zip.exe",
      "Description": "Download and save 7zip to disk in the current folder.",
      "Usecase": "Download file from Internet",
      "Category": "Download",
      "Privileges": "User",
      "MitreID": "T1105",
      "OperatingSystem": "Windows vista, Windows 7, Windows 8, Windows 8.1, Windows 10, Windows 11"
    },
    {
      "Command": "certutil -encode inputFileName encodedOutputFileName",
      "Description": "Command to encode a file using Base64",
      "Usecase": "Encode files to evade defensive measures",
      "Category": "Encode",
      "Privileges": "User",
      "MitreID": "T1027.013",
      "OperatingSystem": "Windows vista, Windows 7, Windows 8, Windows 8.1, Windows 10, Windows 11"
    }
  ],
  "Full_Path": [
    {
      "Path": "C:\\Windows\\System32\\certutil.exe"
    },
    {
      "Path": "C:\\Windows\\SysWOW64\\certutil.exe"
    }
  ],
  "Detection": [
    {
      "key": "Sigma",
      "value": [
        {
          "label": "proc_creation_win_certutil_download.yml",
          "href": "https://github.com/SigmaHQ/sigma/blob/62d4fd26b05f4d81973e7c8e80d7c1a0c6a29d0e/rules/windows/process_creation/proc_creation_win_certutil_download.yml",
          "isUrl": true
        }
      ]
    },
    {
      "key": "IOC",
      "value": [
        {
          "label": "Certutil.exe creating new files on disk",
          "isUrl": false
        }
      ]
    }
  ],
  "Resources": [
    {
      "Link": "https://twitter.com/Moriarty_Meng/status/984380793383370752"
    },
    {
      "Link": "https://twitter.com/mattifestation/status/620107926288515072"
    }
  ],
  "url": "https://lolbas-project.github.io/lolbas/Binaries/Certutil/",
  "extra_metadata_to_filter": {
    "internal_id": "lolbas-12345",
    "last_updated": "2024-01-15T10:30:00Z",
    "cache_expiry": 3600
  },
  "debug_info": {
    "query_time_ms": 45,
    "source": "api"
  }
}
